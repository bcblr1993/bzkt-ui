var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,n=(a,t,s)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,i=(e,a)=>{for(var t in a||(a={}))r.call(a,t)&&n(e,t,a[t]);if(s)for(var t of s(a))d.call(a,t)&&n(e,t,a[t]);return e},o=(e,s)=>a(e,t(s));import{g as l}from"./feed.1305fc25.js";import{u,a as c}from"./useFixVanList.05be6005.js";import{u as f,l as p}from"./index.module.42bc8fe5.js";import{c as v,o as m,n as y,D as g,s as _,q as h,J as b,G as C,B as w,t as x,a6 as j,a7 as k,a8 as O,e as M,w as $,x as q,M as I,F as D,a9 as P,aa as W,p as z,f as T,ab as A,O as B,Q as E}from"./vendor.986fff3c.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import{d as F}from"./dayjs.1e2967e1.js";import"./index.764959f2.js";k("data-v-3b61e423");const L={class:"feedCard"},V={class:"userInfo"},Y={class:"userInfoBody"},S={class:"userName"},U={class:"userCreatedAt"},N={key:0},G={class:"feedContent"};O();var J=v({props:{user:{type:null,required:!0},createdAt:{type:String,required:!0},msg:{type:String,required:!1,default:""}},setup(e){const a=e=>{const a=F(),t=F(e);return a.year()!==t.year()?t.format("YYYY-MM-DD"):t.isBefore(a.subtract(1,"day"),"day")?t.format("MM-DD"):t.fromNow()};return(t,s)=>(m(),y("div",L,[g("div",V,[_(h(b),{class:"userAvatar",round:"",width:"48px",height:"48px",src:e.user.avatar},null,8,["src"]),g("div",Y,[g("div",S,C(e.user.name),1),g("div",U,[w(C(h(a)(e.createdAt))+" ",1),""!==e.msg?(m(),y("span",N," · "+C(e.msg),1)):x("",!0)])])]),g("div",G,[j(t.$slots,"default",{},void 0,!0)])]))}});J.__scopeId="data-v-3b61e423";var Q=v({props:{feed:{type:null,required:!0}},setup(e){const a=e;return(t,s)=>(m(),M(J,{user:e.feed.user,"created-at":e.feed.created_at},{default:$((()=>[g("div",null,[g("div",{class:q(t.$style.feedContentContent)},C(e.feed.content),3),g("div",{class:q(t.$style.feedImagesContainer)},[(m(!0),y(D,null,I(e.feed.images,((e,s)=>(m(),y("div",{key:s,class:q(t.$style.imageWrapper)},[_(h(b),{src:e,radius:4,"lazy-load":"",fit:"cover",width:"100%",height:"100%",onClick:e=>(e=>{P({images:a.feed.images,startPosition:e})})(s)},null,8,["src","onClick"])],2)))),128))],2)])])),_:1},8,["user","created-at"]))}});var R={feedContentContent:"_feedContentContent_rfmt9_2",feedImagesContainer:"_feedImagesContainer_rfmt9_6",imageWrapper:"_imageWrapper_rfmt9_20"};(Q.__cssModules={}).$style=R;var H=v(o(i({},defineComponent({directives:{race:{mounted(e){e.style.height=e.offsetWidth/16*9+"px",window.addEventListener("resize",(()=>{e.style.height=e.offsetWidth/16*9+"px"})),e.addEventListener("resize",(()=>{e.style.height=e.offsetWidth/16*9+"px"}))}}}})),{props:{feed:{type:null,required:!0}},setup(e){const a=u();return(t,s)=>{const r=W("race");return m(),M(J,{user:e.feed.user,"created-at":e.feed.created_at,msg:"投稿了视频"},{default:$((()=>[g("div",{onClick:s[0]||(s[0]=t=>h(a)(e.feed.video.id))},[z(g("div",null,[_(h(b),{width:"100%",height:"100%",src:e.feed.video.cover,radius:"8","lazy-load":""},null,8,["src"])],512),[[r]]),g("div",{class:q(t.$style.videoTitle)},C(e.feed.video.title),3)])])),_:1},8,["user","created-at"])}}}));var K={videoTitle:"_videoTitle_1qkoa_2"};(H.__cssModules={}).$style=K;var X=v(o(i({},defineComponent({name:"FeedCard"})),{props:{feed:{type:null,required:!0}},setup(e){const a=e,t=computed((()=>{switch(a.feed.type){case"normal":return Q;case"video":return H;default:!function(e){throw new Error("Unexpected object: "+e)}(a.feed)}}));return(a,s)=>(m(),M(T(h(t)),{feed:e.feed},null,8,["feed"]))}}));const Z={class:"van-clearfix"};var ee=v(o(i({},defineComponent({name:"Feed"})),{setup(e){const a=A([]),t=reactive({page:1,per_page:10}),s=A(!1),r=A(!1),d=A(!1),n=async(e=!1)=>{let s;try{s=await l(t)}catch(n){return void console.error(n)}const r=s.data;a.value=e?a.value.concat(r):r,d.value=r.length<t.per_page},i=async()=>{!0!==d.value&&(r.value=!0,t.page++,await n(!0),await nextTick(),r.value=!1)},o=async()=>{t.page=1,d.value=!1,await n(),await nextTick(),s.value=!1};onBeforeMount((async()=>{await n()})),f();const u=A();return c(u),(e,t)=>(m(),M(h(E),{modelValue:s.value,"onUpdate:modelValue":t[1]||(t[1]=e=>s.value=e),onRefresh:o},{default:$((()=>[_(h(B),{ref:u,loading:r.value,"onUpdate:loading":t[0]||(t[0]=e=>r.value=e),class:q([e.$style.listContainer,h(p)]),"immediate-check":!1,finished:d.value,"finished-text":"没有更多了",onLoad:i},{default:$((()=>[g("div",Z,[(m(!0),y(D,null,I(a.value,(e=>(m(),M(X,{key:e.id,feed:e},null,8,["feed"])))),128))])])),_:1},8,["loading","class","finished"])])),_:1},8,["modelValue"]))}}));var ae={listContainer:"_listContainer_1bxlz_2"};(ee.__cssModules={}).$style=ae;export{ee as default};

import{c as a,o as e,n as t,D as s,s as p,x as c,q as n,I as l,p as o,E as r,G as u,w as i,B as h,H as d,T as m}from"./vendor.986fff3c.js";import{r as _}from"./index.764959f2.js";import{s as x}from"./sleep.d3439312.js";/* empty css              */const y=[s("span",null,"+86",-1)],f=[s("span",null,"获取验证码",-1)];var v=a({props:{submitText:{type:String,required:!1,default:"注册/登录"}},emits:["submit"],setup(a,{emit:v}){const I=reactive({phone:"",captcha:""}),$=()=>/^1[3456789]\d{9}$/.test(I.phone),B=()=>{$()?/^\d{4}$/.test(I.captcha)?v("submit",I):m.fail("验证码格式有误"):m.fail("手机号格式有误")},b=function(){const a=ref(0);return watchEffect((async()=>{a.value<=0?a.value=0:(await x(),a.value--,await nextTick())})),a}(),W=async()=>{if(0!==b.value)return;if(!$())return void m.fail("手机号格式有误");const a=m.loading({message:"加载中...",forbidClick:!0});try{await(e=I.phone,_({data:{phone:e},url:"/captchas",method:"POST"}))}catch(t){return console.error(t),void a.clear()}var e;a.clear(),m.success("验证码发送成功"),b.value=60};return(m,_)=>(e(),t("div",{class:c(m.$style.form)},[s("div",{class:c(m.$style.phoneWrapper)},[p(n(l),{class:c(m.$style.icon),name:"contact",size:"28",color:"#555555"},null,8,["class"]),s("div",{class:c(m.$style.phoneInputWrapper)},[s("div",{class:c(m.$style.phoneCode)},y,2),s("div",{class:c(m.$style.phoneInputBody)},[s("label",null,[o(s("input",{"onUpdate:modelValue":_[0]||(_[0]=a=>n(I).phone=a),class:c(m.$style.phoneInput),type:"text",placeholder:"手机号",maxlength:"11"},null,2),[[r,n(I).phone]])]),0===n(b)?(e(),t("div",{key:0,class:c(m.$style.captchaButton),onClick:W},f,2)):(e(),t("div",{key:1,class:c(m.$style.captchaCd)},[s("span",null,u(n(b))+"s后重发",1)],2))],2)],2)],2),s("div",{class:c(m.$style.captchaWrapper)},[p(n(l),{class:c(m.$style.icon),name:"comment-o",size:"28",color:"#555555"},null,8,["class"]),s("div",{class:c(m.$style.captchaInputWrapper)},[s("div",{class:c(m.$style.captchaInputBody)},[s("label",null,[o(s("input",{"onUpdate:modelValue":_[1]||(_[1]=a=>n(I).captcha=a),class:c(m.$style.captchaInput),type:"text",placeholder:"验证码",maxlength:"4"},null,2),[[r,n(I).captcha]])])],2)],2)],2),p(n(d),{class:c(m.$style.submitButton),type:"primary",size:"large",onClick:B},{default:i((()=>[h(u(a.submitText),1)])),_:1},8,["class"])],2))}});var I={form:"_form_e5xmx_2",phoneWrapper:"_phoneWrapper_e5xmx_5",captchaWrapper:"_captchaWrapper_e5xmx_6",phoneInputWrapper:"_phoneInputWrapper_e5xmx_14",captchaInputWrapper:"_captchaInputWrapper_e5xmx_15",phoneCode:"_phoneCode_e5xmx_21",phoneInputBody:"_phoneInputBody_e5xmx_31",phoneInput:"_phoneInput_e5xmx_14",captchaButton:"_captchaButton_e5xmx_48",captchaCd:"_captchaCd_e5xmx_53",captchaInputBody:"_captchaInputBody_e5xmx_58",captchaInput:"_captchaInput_e5xmx_15",submitButton:"_submitButton_e5xmx_74"};(v.__cssModules={}).$style=I;export{v as _};

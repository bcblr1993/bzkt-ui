import{c as e,m as t,o as a,n,s as o,q as s,N as r,D as i,Z as l,x as c,G as d,_ as m,T as f}from"./vendor.986fff3c.js";import{c as u}from"./feed.1305fc25.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./index.764959f2.js";const p={class:"form"};var x=e({setup(e){const x=t(),g=reactive({content:"",images:[]}),v=ref();onMounted((()=>{var e;null==(e=v.value)||e.focus()}));const _=e=>(Array.isArray(e)||(e=[e]),e.some((e=>!e.type.startsWith("image/")))&&f.fail("请上传图片文件"),!0),C=async()=>{if(0===g.content.trim().length&&(f.fail("请输入内容！"),1))return;const e=f.loading("上传中..."),t=g.images.map((e=>e.file)),a={content:g.content};try{await u(t,a)}catch(n){return console.error(n),void e.clear()}e.clear(),f.success("发布成功"),x.back()};return(e,t)=>(a(),n("div",{class:c(e.$style.container)},[o(s(r),{title:"","left-text":"返回","right-text":"发布",onClickLeft:t[0]||(t[0]=t=>e.$router.back()),onClickRight:C}),i("div",p,[o(s(l),{ref:v,modelValue:s(g).content,"onUpdate:modelValue":t[1]||(t[1]=e=>s(g).content=e),rows:5,autosize:"",type:"textarea",placeholder:"分享我的动态",border:!1},null,8,["modelValue"]),i("div",{class:c(e.$style.feedContentCount)},d(s(g).content.length),3),i("div",{class:c(e.$style.feedImageContainer)},[o(s(m),{modelValue:s(g).images,"onUpdate:modelValue":t[2]||(t[2]=e=>s(g).images=e),multiple:"","max-count":9,"preview-size":"var(--full-width-30)","before-read":_},null,8,["modelValue"])],2)])],2))}});var g={container:"_container_55arc_2",feedContentCount:"_feedContentCount_55arc_5",feedImageContainer:"_feedImageContainer_55arc_37"};(x.__cssModules={}).$style=g;export{x as default};
